# 文采项目

## 项目简介

文采项目是一款专注于文字美与力量的产品，结合音乐，为用户提供一个摘抄和分享美文的平台。用户可以通过不同的句子类型，如文学美句摘抄、诗词摘抄、歇后语、冷笑话、段子、热评、故事等，来整理和组合文字内容。平台还支持通过标签和文辑进行内容的分类和管理，用户可以在社区中分享自己的动态和摘抄，交流和发现更多美文。

## 功能特点

- **多种句子类型**: 支持文学美句摘抄、诗词摘抄、歇后语、冷笑话、段子、热评、故事等多种类型的句子。
- **标签管理**: 通过标签对句子进行分类，方便用户查找和管理。
- **文辑整理**: 用户可以将句子整理成文辑，进行系统化的管理和展示。
- **社区分享**: 用户可以在社区中分享自己的动态和摘抄，与其他用户互动交流。
- **音乐结合**: 为每个句子或文辑添加背景音乐，增强文字的表现力和感染力。

## 目标用户

- 喜爱文字和文学的用户
- 需要摘抄和整理美文的用户
- 喜欢分享和交流文字内容的用户
- 追求文字美与力量的用户
- 需要通过文字和音乐放松心情的用户

## 数据表设计

### 数据表设计

以下是文采项目的数据表设计，包括字段描述及表之间的关系：

#### 1. **个人信息表 (profiles)**

- **字段**:
  - `nickName` (string): 昵称
  - `sgin` (string): 个性签名
  - `icon` (string): 图标
  - `birthday` (string): 生日
  - `wx_id` (string): 微信 ID
  - `iphone` (string): 手机号
  - `userId` (string, 必填): 用户 ID
- **关系**: 无

#### 2. **类型表 (types)**

- **字段**:
  - `name` (string, 必填): 名称
  - `description` (string): 描述
  - `icon` (string): 图标
  - `userId` (string, 必填): 用户 ID
- **关系**:
  - 与文字表 (texts) 为多对多关系
  - 与专辑表 (albums) 为一对多关系

#### 3. **标签表 (tags)**

- **字段**:
  - `name` (string, 必填): 名称
  - `hotness` (number): 热度
  - `userId` (string, 必填): 用户 ID
- **关系**:
  - 与文字表 (texts) 为多对多关系

#### 4. **文字表 (texts)**

- **字段**:
  - `title` (string): 标题
  - `content` (string, 必填, 最大长度 5000): 内容
  - `author` (string): 作者
  - `userId` (string, 必填): 用户 ID
  - `images` (string[], 可选): 图片数组
  - `isPublic` (boolean, 必填): 是否公开
- **关系**:
  - 与音乐表 (music) 为多对一关系
  - 与评论表 (comments) 为一对多关系
  - 与标签表 (tags) 为多对多关系
  - 与类型表 (types) 为多对多关系

#### 5. **专辑表 (albums)**

- **字段**:
  - `title` (string, 必填): 标题
  - `description` (string, 最大长度 1000): 描述
  - `coverImage` (string): 封面图片
  - `userId` (string, 必填): 用户 ID
  - `isPublic` (boolean, 必填): 是否公开
- **关系**:
  - 与文字表 (texts) 为一对多关系
  - 与类型表 (types) 为一对多关系
  - 与音乐表 (music) 为多对一关系

#### 6. **动态表 (posts)**

- **字段**:
  - `content` (string, 必填): 内容
  - `userId` (string, 必填): 用户 ID
  - `images` (string[], 可选): 图片数组
  - `isPublic` (boolean, 必填): 是否公开
- **关系**:
  - 与文字表 (texts) 为一对一关系

#### 7. **今日推荐表 (recommendations)**

- **字段**:
  - `userId` (string, 必填): 用户 ID
  - `date` (string, 必填): 日期
- **关系**:
  - 与文字表 (texts) 为一对多关系

#### 8. **评论表 (comments)**

- **字段**:
  - `content` (string, 必填): 内容
  - `userId` (string, 必填): 用户 ID
  - `parentId` (string, 可选): 父评论 ID
- **关系**: 无

#### 9. **点赞表 (likes)**

- **字段**:
  - `userId` (string, 必填): 用户 ID
  - `targetType` (enum, 必填): 目标类型，支持 ["文字", "专辑", "标签", "音乐", "其他"]
  - `targetId` (string, 必填): 目标 ID
- **关系**: 无

#### 10. **收藏表 (favorites)**

- **字段**:
  - `userId` (string, 必填): 用户 ID
  - `targetType` (enum, 必填): 目标类型，支持 ["文字", "专辑", "标签", "音乐", "其他"]
  - `targetId` (string, 必填): 目标 ID
- **关系**: 无

#### 11. **音乐表 (music)**

- **字段**:
  - `userId` (string, 必填): 用户 ID
  - `title` (string, 必填): 标题
  - `url` (string, 必填): URL
  - `coverImage` (string): 封面图片
  - `artist` (string): 艺术家
  - `album` (string): 专辑
  - `genre` (string): 流派
  - `releaseDate` (string): 发行日期
  - `duration` (number): 时长
- **关系**:
  - 与文字表 (texts) 为一对多关系
  - 与专辑表 (albums) 为一对多关系

#### 12. **用户画像表 (user_profiles)**

- **字段**:
  - `userId` (string, 必填): 用户 ID
  - `tagPreferences` (object): 标签偏好，存储标签及其权重，例如 `{ "文学": 10, "诗词": 8 }`
  - `lastUpdated` (string): 上次更新日期
  - `behaviorData` (object): 用户行为数据统计，例如 `{ "收藏": 50, "点赞": 30, "浏览": 100 }`
- **关系**: 无

#### 13. **用户历史浏览文字表 (history_views)**

- **字段**:

  - `userId` (string, 必填): 用户 ID
  - `textId` (string, 必填): 文字 ID
  - `viewedAt` (string): 浏览时间
  - `duration` (number): 浏览时长（秒）

- **用途**:

  - 记录用户浏览文字的历史数据。
  - 为推荐逻辑提供用户行为数据支持。
  - 用于分析用户兴趣和偏好。

- **示例数据**:
  - `{ "userId": "123", "textId": "456", "viewedAt": "2023-10-01T12:00:00Z", "duration": 120 }`

#### 13. **推荐逻辑**

通过分析用户收藏、点赞和浏览记录中的标签，生成个性化推荐内容：

- **逻辑描述**:

  - 统计用户与标签的交互频率（如收藏、点赞、浏览等）。
  - 根据标签的热度和用户的交互频率，筛选出用户最感兴趣的标签。
  - 基于用户喜好的标签，从文字表 (texts) 中推荐相关内容。

- **用户画像**:

  - **行为数据**: 收集用户的收藏、点赞、浏览记录等行为数据。
  - **兴趣标签**: 根据用户行为数据，提取用户感兴趣的标签。
  - **偏好权重**: 为每个标签分配权重，权重由用户与标签的交互频率决定。
  - **动态更新**: 用户画像会随着用户行为的变化而动态更新。

- **实现方式**:

  - 定期计算用户的标签偏好分数：
    - 偏好分数 = 收藏次数 _ 3 + 点赞次数 _ 2 + 浏览次数 \* 1。
  - 根据偏好分数排序，筛选出用户最感兴趣的标签。
  - 从文字表 (texts) 中筛选与用户标签匹配的内容。
  - 支持按时间、热度等维度进一步排序。

- **推荐结果展示**:
  - 在用户首页或推荐页面展示推荐的文字内容。
  - 提供多种筛选和排序方式，方便用户查找感兴趣的内容。

#### 权重计算逻辑

- **公式**:

  - 标签权重 = 收藏次数 × 3 + 点赞次数 × 2 + 浏览次数 × 1

- **步骤**:

  1. 收集用户的行为数据，包括收藏、点赞和浏览记录。
  2. 按照公式计算每个标签的权重。
  3. 将计算结果存储到 `tagPreferences` 字段中。

- **示例**:

  - 用户行为数据: `{ "收藏": 10, "点赞": 5, "浏览": 20 }`
  - 计算结果:
    - 标签 A 权重 = 10 × 3 + 5 × 2 + 20 × 1 = 50
    - 标签 B 权重 = 5 × 3 + 3 × 2 + 10 × 1 = 29
  - 存储结果: `{ "标签A": 50, "标签B": 29 }`

- **动态更新**:
  - 定期重新计算权重，确保用户画像与用户最新行为保持一致。
  - 更新 `lastUpdated` 字段以记录权重更新的时间。
